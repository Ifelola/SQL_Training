--Instructions:
--Retrieve information about people who are diabetic and have heart problems with
--their average age, the average number of dependent children, average BMI, and
--average hospitalization costs.SELECT    c.[Customer ID],    c.name,    2024 - TRY_CAST(h.year AS INT)                                      AS Age,    h.children,    m.BMI,    h.charges,    AVG(TRY_CAST(2024 - TRY_CAST(h.year AS INT) AS FLOAT)) OVER()       AS Avg_Age,    AVG(TRY_CAST(h.children AS FLOAT))                     OVER()       AS Avg_Dependent_Children,    AVG(TRY_CAST(m.BMI AS FLOAT))                          OVER()       AS Avg_BMI,    AVG(TRY_CAST(h.charges AS FLOAT))                      OVER()       AS Avg_Hospitalization_CostFROM [dbo].[InterviewCustomerId]              cJOIN [dbo].[InterviewHospitalisationDetails]  h ON h.[Customer ID] = c.[Customer ID]JOIN [dbo].[InterviewMedicalExaminations]     m ON m.[Customer ID] = c.[Customer ID]WHERE TRY_CAST(m.HBA1C AS FLOAT) >= 6.5  AND m.[Heart Issues] = 'yes'  -- AND m.[Heart Issues] In ('yes','No')  -- Find the average hospitalization cost for each hospital tier and each city level.  SELECT    h.[Hospital tier],    h.[City tier],   AVG(TRY_CAST(h.charges AS FLOAT)) AS Avg_Hospitalization_CostFROM [dbo].[InterviewHospitalisationDetails] hGROUP BY h.[Hospital tier], h.[City tier]ORDER BY h.[Hospital tier], h.[City tier];SELECT       AVG(TRY_CAST(h.charges AS FLOAT)) AS Avg_Hospitalization_Cost FROM [dbo].[InterviewHospitalisationDetails] h-- Determine the number of people who have had major surgery with a history of cancerSELECT    COUNT(m.[Customer ID]) AS PatientCountFROM [dbo].[InterviewMedicalExaminations] mWHERE m.[Cancer history] = 'Yes'  AND m.[NumberOfMajorSurgeries] In ('1','2','3')  --AND m.[NumberOfMajorSurgeries] <> 'No major surgery' --Determine the number of tier-1 hospitals in each state SELECT     [State ID],	[Hospital tier],    COUNT(*) AS NumberOfTier1HospitalsFROM [dbo].[InterviewHospitalisationDetails]WHERE     [Hospital tier] = 'tier - 1' GROUP BY     [State ID],[Hospital tier]ORDER BY     NumberOfTier1Hospitals DESC